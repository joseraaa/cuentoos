<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>La tortuga y la liebre</title>
  <link href="https://fonts.googleapis.com/css2?family=Chewy&family=Freckle+Face&family=Comic+Neue:wght@300;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #ff9a8b;
      --color-secondary: #ffd3b5;
      --color-accent: #6b5b95;
      --color-light: #fff8f0;
      --color-dark: #333;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Comic Neue', cursive;
      background: var(--color-light);
      color: var(--color-dark);
      line-height: 1.6;
      padding: 2rem;
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
    }

    header h1 {
      font-family: 'Freckle Face', cursive;
      font-size: 3rem;
      color: var(--color-accent);
    }

    .cuento {
      max-width: 700px;
      margin: auto;
      background: white;
      padding: 2rem;
      border: 3px dashed var(--color-accent);
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .cuento h2 {
      font-family: 'Freckle Face', cursive;
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--color-primary);
    }

    .cuento p {
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    .controls {
      margin-top: 1rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .btn-volver, .btn-narrar {
      display: inline-block;
      padding: 0.5rem 1.5rem;
      background: var(--color-primary);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      transition: background 0.3s ease;
      cursor: pointer;
      border: none;
    }

    .btn-volver:hover,
    .btn-narrar:hover {
      background: var(--color-accent);
    }

    .highlight {
      background-color: var(--color-secondary);
      font-weight: bold;
    }

    footer {
      text-align: center;
      margin-top: 3rem;
      padding: 1rem;
      background: var(--color-accent);
      color: white;
      border-radius: 12px;
    }
  </style>
</head>
<body>

  <header>
    <h1>MiBiblioteca</h1>
  </header>

  <section class="cuento">
    <h2>El conejito soñador</h2>

    <div class="controls">
      <button class="btn-narrar" onclick="narrarCuento()">🔊 Escuchar</button>
      <button class="btn-narrar" onclick="pausarCuento()">⏸️ Pausar</button>
      <button class="btn-narrar" onclick="reanudarCuento()">▶️ Reanudar</button>
      <button class="btn-narrar" onclick="detenerCuento()">⏹️ Detener</button>
      <a href="index.html" class="btn-volver">← Volver a cuentos</a>
    </div>
<div id="texto-cuento">
    
    
  <p>Había una vez un conejito soñador que vivía en una casita en medio del bosque, rodeado de libros y fantasía, pero no tenía amigos. Todos le habían dado de lado porque se pasaba el día contando historias imaginarias sobre hazañas caballerescas, aventuras submarinas y expediciones extraterrestres. Siempre estaba inventando aventuras como si las hubiera vivido de verdad, hasta que sus amigos se cansaron de escucharle y acabó quedándose solo.</p>

  <p>Al principio el conejito se sintió muy triste y empezó a pensar que sus historias eran muy aburridas y por eso nadie las quería escuchar. Pero pese a eso continuó escribiendo.</p>

  <p>Las historias del conejito eran increíbles y le permitían vivir todo tipo de aventuras. Se imaginaba vestido de caballero salvando a inocentes princesas o sintiendo el frío del mar sobre su traje de buzo mientras exploraba las profundidades del océano.</p>

  <p>Se pasaba el día escribiendo historias y dibujando los lugares que imaginaba. De vez en cuando, salía al bosque a leer en voz alta, por si alguien estaba interesado en compartir sus relatos.</p>

  <p>Un día, mientras el conejito soñador leía entusiasmado su último relato, apareció por allí una hermosa conejita que parecía perdida. Pero nuestro amigo estaba tan entregado a la interpretación de sus propios cuentos que ni se enteró de que alguien lo escuchaba. Cuando acabó, la conejita le aplaudió con entusiasmo.</p>

  <p>—Vaya, no sabía que tenía público —dijo el conejito soñador a la recién llegada—. ¿Te ha gustado mi historia?<br>
  —Ha sido muy emocionante —respondió ella—. ¿Sabes más historias?<br>
  —¡Claro! —dijo emocionado el conejito—. Yo mismo las escribo.<br>
  —¿De verdad? ¿Y son todas tan apasionantes?<br>
  —¿Tú crees que son apasionantes? Todo el mundo dice que son aburridísimas…<br>
  —Pues eso no es cierto, a mí me ha gustado mucho. Ojalá yo supiera escribir historias como la tuya pero no sé…</p>

  <p>El conejito se dio cuenta de que la conejita se había puesto de repente muy triste, así que se acercó y, pasándole la patita por encima del hombro, le dijo con dulzura:</p>

  <p>—Yo puedo enseñarte si quieres a escribirlas. Seguro que aprendes muy rápido.<br>
  —¿Sí? ¿Me lo dices en serio?<br>
  —¡Claro que sí! ¡Hasta podríamos escribirlas juntos!<br>
  —¡Genial! Estoy deseando explorar esos lugares, viajar a esos mundos y conocer a todos esos villanos y malandrines —dijo la conejita.</p>

  <p>Los conejitos se hicieron muy amigos y compartieron juegos y escribieron cientos de libros que leyeron a niños de todo el mundo.</p>

  <p>Sus historias jamás contadas y peripecias se hicieron muy famosas y el conejito no volvió jamás a sentirse solo ni tampoco a dudar de sus historias.</p>


</div>
    
  </section>

  <script>
    let utterance;
    let textoOriginal;
    let palabras;

    function narrarCuento() {
      detenerCuento(); // Reinicia si ya hay algo en reproducción

      const contenedor = document.getElementById("texto-cuento");
      textoOriginal = contenedor.innerText;
      palabras = textoOriginal.split(/\s+/);

      // Envuelve cada palabra en un span
      contenedor.innerHTML = palabras.map((palabra, i) =>
        `<span id="palabra-${i}">${palabra}</span>`
      ).join(" ");

      utterance = new SpeechSynthesisUtterance(textoOriginal);
      utterance.lang = 'es-ES';
      utterance.rate = 1;

      utterance.onboundary = (event) => {
        if (event.name === "word" && typeof event.charIndex !== "undefined") {
          const index = getWordIndex(textoOriginal, event.charIndex);
          const spans = document.querySelectorAll('#texto-cuento span');
          spans.forEach(span => span.classList.remove('highlight'));
          const actual = document.getElementById(`palabra-${index}`);
          if (actual) actual.classList.add('highlight');
        }
      };

      utterance.onend = () => {
        // Limpiar resaltado
        const spans = document.querySelectorAll('#texto-cuento span');
        spans.forEach(span => span.classList.remove('highlight'));
      };

      speechSynthesis.speak(utterance);
    }

    function pausarCuento() {
      if (speechSynthesis.speaking && !speechSynthesis.paused) {
        speechSynthesis.pause();
      }
    }

    function reanudarCuento() {
      if (speechSynthesis.paused) {
        speechSynthesis.resume();
      }
    }

    function detenerCuento() {
      if (speechSynthesis.speaking || speechSynthesis.paused) {
        speechSynthesis.cancel();
      }
      // Limpiar resaltado
      const spans = document.querySelectorAll('#texto-cuento span');
      spans.forEach(span => span.classList.remove('highlight'));
    }

    function getWordIndex(text, charIndex) {
      const before = text.slice(0, charIndex);
      return before.trim().split(/\s+/).length - 1;
    }
  </script>

</body>
</html>